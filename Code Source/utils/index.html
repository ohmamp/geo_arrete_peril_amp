<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Utils - Geo Arrêtés</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../assets/_mkdocstrings.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Utils";
        var mkdocs_page_input_path = "Code Source\\utils.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> Geo Arrêtés
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Index</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../install/">Guide d'installation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Code Source</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../domain_knowledge/">Domain Knowledge</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../preprocess/">Preprocess</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../process/">Process</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../quality/">Quality</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">Utils</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#fonctions-utiles-pour-la-gestion-des-fichiers">Fonctions utiles pour la gestion des fichiers</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#src.utils.file_utils">file_utils</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#src.utils.file_utils.get_file_digest">get_file_digest()</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#reconnaissance-et-mise-en-forme-des-dates">Reconnaissance et mise en forme des dates</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#src.utils.str_date">str_date</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#src.utils.str_date.process_date_brute">process_date_brute()</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#fonctions-utilitaires-generiques-pour-le-texte">Fonctions utilitaires génériques pour le texte</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#src.utils.text_utils">text_utils</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#src.utils.text_utils.create_file_name_url">create_file_name_url()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#src.utils.text_utils.normalize_string">normalize_string()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#src.utils.text_utils.remove_accents">remove_accents()</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#charger-les-fichiers-de-texte-extraits-des-pdf-natifs-ou-non">Charger les fichiers de texte extraits des PDF, natifs ou non</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#src.utils.txt_format">txt_format</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#src.utils.txt_format.load_pages_text">load_pages_text()</a>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Notebooks</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../Notebooks/notebooks/">Notebooks</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Scripts</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../Scripts/scripts/">Scripts</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">Geo Arrêtés</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Code Source</li>
      <li class="breadcrumb-item active">Utils</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="utils">Utils</h1>
<p>Diverses fonctions utilitaires.</p>
<h2 id="fonctions-utiles-pour-la-gestion-des-fichiers">Fonctions utiles pour la gestion des fichiers</h2>


<div class="doc doc-object doc-module">



<a id="src.utils.file_utils"></a>
  <div class="doc doc-contents first">
  
      

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="src.utils.file_utils.get_file_digest" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_file_digest</span><span class="p">(</span><span class="n">fp_pdf</span><span class="p">,</span> <span class="n">digest</span><span class="o">=</span><span class="s1">&#39;blake2b&#39;</span><span class="p">,</span> <span class="n">digest_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Extraire le hachage d'un fichier avec la fonction <code>digest</code>.</p>
<p>Fonctionne pour Python &gt;= 3.8, mais le code pourra être simplifié
pour Python &gt;= 3.11 quand ce sera la version minimale requise par
les principaux projets.</p>



<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>fp_pdf</code></b>
                  (<code><span title="pathlib.Path">Path</span></code>)
              –
              <div class="doc-md-description">
                <p>Chemin du fichier PDF à traiter.</p>
              </div>
            </li>
            <li>
              <b><code>digest</code></b>
                  (<code>str</code>, default:
                      <code>&#39;blake2b&#39;</code>
)
              –
              <div class="doc-md-description">
                <p>Nom de la fonction de hachage à utiliser, "sha1" par défaut.</p>
              </div>
            </li>
            <li>
              <b><code>digest_size</code></b>
                  (<code>int</code>, default:
                      <code>10</code>
)
              –
              <div class="doc-md-description">
                <p>Taille du digest (blake2b, sinon ignoré).</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
      <ul class="first simple">
          <li>
<b><code>fd_hexdigest</code></b>(                <code>str</code>
)            –
            <div class="doc-md-description">
              <p>Hachage du fichier.</p>
            </div>
          </li>
      </ul>
    </td>
    </tr>
  </tbody>
</table>
  </div>

</div>



  </div>

  </div>

</div><h2 id="reconnaissance-et-mise-en-forme-des-dates">Reconnaissance et mise en forme des dates</h2>


<div class="doc doc-object doc-module">



<a id="src.utils.str_date"></a>
  <div class="doc doc-contents first">
  
      

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="src.utils.str_date.process_date_brute" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">process_date_brute</span><span class="p">(</span><span class="n">arr_date</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Extraire les différents champs d'une date brute et la normaliser.</p>



<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>arr_date</code></b>
                  (<code>str</code>)
              –
              <div class="doc-md-description">
                <p>Date brute</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
      <ul class="first simple">
          <li>
<b><code>arr_date_norm</code></b>(                <code>str</code>
)            –
            <div class="doc-md-description">
              <p>Date normalisée dd/mm/yyyy</p>
            </div>
          </li>
      </ul>
    </td>
    </tr>
  </tbody>
</table>
  </div>

</div>



  </div>

  </div>

</div><h2 id="fonctions-utilitaires-generiques-pour-le-texte">Fonctions utilitaires génériques pour le texte</h2>


<div class="doc doc-object doc-module">



<a id="src.utils.text_utils"></a>
  <div class="doc doc-contents first">
  
      

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="src.utils.text_utils.create_file_name_url" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">create_file_name_url</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">allowance</span><span class="o">=</span><span class="mi">155</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Creates a URL-compliant filename by removing non-alphanumeric characters,
accentuated letters, and maintaining the Windows path length limit.</p>



<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>file_name</code></b>
                  (<code>str</code>)
              –
              <div class="doc-md-description">
                <p>Nom du fichier</p>
              </div>
            </li>
            <li>
              <b><code>allowance</code></b>
                  (<code>int</code>, default:
                      <code>155</code>
)
              –
              <div class="doc-md-description">
                <p>Longueur maximale du chemin complet (chemin + nom de fichier)</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="src.utils.text_utils.normalize_string" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">normalize_string</span><span class="p">(</span><span class="n">raw_str</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">apos</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">hyph</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">spaces</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Normaliser une chaîne de caractères.</p>
<p>Remplacer les séquences d'espaces par une unique espace.</p>



<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>raw_str</code></b>
                  (<code>str</code>)
              –
              <div class="doc-md-description">
                <p>Chaîne de caractères à normaliser</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
      <ul class="first simple">
          <li>
<b><code>nor_str</code></b>(                <code>str</code>
)            –
            <div class="doc-md-description">
              <p>Chaîne de caractères normalisée</p>
            </div>
          </li>
      </ul>
    </td>
    </tr>
  </tbody>
</table>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="src.utils.text_utils.remove_accents" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">remove_accents</span><span class="p">(</span><span class="n">str_in</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Enlève les accents d'une chaîne de caractères.</p>
<p>cf. <a href="https://stackoverflow.com/a/517974">https://stackoverflow.com/a/517974</a></p>



<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>str_in</code></b>
                  (<code>str</code>)
              –
              <div class="doc-md-description">
                <p>Chaîne de caractères pouvant contenir des caractères combinants
(accents, cédille etc.).</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
      <ul class="first simple">
          <li>
<b><code>str_out</code></b>(                <code>string</code>
)            –
            <div class="doc-md-description">
              <p>Chaîne de caractères sans caractère combinant.</p>
            </div>
          </li>
      </ul>
    </td>
    </tr>
  </tbody>
</table>
  </div>

</div>



  </div>

  </div>

</div><h2 id="charger-les-fichiers-de-texte-extraits-des-pdf-natifs-ou-non">Charger les fichiers de texte extraits des PDF, natifs ou non</h2>


<div class="doc doc-object doc-module">



<a id="src.utils.txt_format"></a>
  <div class="doc doc-contents first">
  
      

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="src.utils.txt_format.load_pages_text" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">load_pages_text</span><span class="p">(</span><span class="n">fp_txt</span><span class="p">,</span> <span class="n">page_break</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\x0c</span><span class="s1">&#39;</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Charge le texte d'un document, découpé en pages.</p>



<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>fp_txt</code></b>
                  (<code><span title="pathlib.Path">Path</span></code>)
              –
              <div class="doc-md-description">
                <p>Chemin du fichier contenant le texte d'un document.</p>
              </div>
            </li>
            <li>
              <b><code>page_break</code></b>
                  (<code>str</code>, default:
                      <code>&#39;\x0c&#39;</code>
)
              –
              <div class="doc-md-description">
                <p>Séparateur de pages. Les fichiers PDF texte produits par l'export
direct depuis les logiciels de traitement de texte contiennent
déjà un "form feed" (""), comme les fichiers "sidecar" produits
par ocrmypdf (pour les fichiers PDF image).</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
      <ul class="first simple">
          <li>
<b><code>doc_txt</code></b>(                <code><span title="typing.List">List</span>[str]</code>
)            –
            <div class="doc-md-description">
              <p>Texte du document, par page.</p>
            </div>
          </li>
      </ul>
    </td>
    </tr>
  </tbody>
</table>
  </div>

</div>



  </div>

  </div>

</div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../quality/" class="btn btn-neutral float-left" title="Quality"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../../Notebooks/notebooks/" class="btn btn-neutral float-right" title="Notebooks">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../quality/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../../Notebooks/notebooks/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
